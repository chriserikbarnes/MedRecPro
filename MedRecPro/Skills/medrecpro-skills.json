{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "MedRecPro AI Skills Document",
  "description": "Comprehensive reference for AI agent interpretation of user requests in the MedRecPro pharmaceutical labeling management system",
  "version": "1.0.0",
  "lastUpdated": "2024-12-09",
  "systemInfo": {
    "name": "MedRecPro",
    "description": "SPL (Structured Product Labeling) pharmaceutical labeling management system based on FDA SPL Implementation Guide",
    "baseApiPath": "/api",
    "authenticationMethods": ["Google OAuth", "Microsoft OAuth", "Cookie-based"],
    "dataEncryption": "All primary/foreign keys are encrypted using secure cipher"
  },
  "capabilities": {
    "navigationViews": {
      "description": "Search and discovery endpoints for navigating pharmaceutical data",
      "endpoints": [
        {
          "category": "Application Number Navigation",
          "description": "Search products by FDA application number (NDA, ANDA, BLA)",
          "endpoints": [
            {
              "name": "Search by Application Number",
              "method": "GET",
              "path": "/api/views/application-number/search",
              "description": "Find products associated with a specific regulatory application number",
              "parameters": {
                "applicationNumber": {
                  "type": "string",
                  "required": true,
                  "description": "The application number to search (e.g., NDA014526, ANDA125669, BLA103795)",
                  "examples": ["NDA020702", "ANDA", "125669"]
                },
                "pageNumber": {
                  "type": "integer",
                  "required": false,
                  "description": "1-based page number"
                },
                "pageSize": {
                  "type": "integer",
                  "required": false,
                  "description": "Number of records per page"
                }
              },
              "responseType": "array",
              "triggerPhrases": [
                "find by application number",
                "search NDA",
                "search ANDA",
                "search BLA",
                "what products are under NDA"
              ]
            },
            {
              "name": "Application Number Summaries",
              "method": "GET",
              "path": "/api/views/application-number/summaries",
              "description": "Get aggregated counts of products and documents by application number",
              "parameters": {
                "marketingCategory": {
                  "type": "string",
                  "required": false,
                  "description": "Filter by marketing category code (NDA, ANDA, BLA)"
                },
                "pageNumber": { "type": "integer", "required": false },
                "pageSize": { "type": "integer", "required": false }
              },
              "responseType": "array",
              "triggerPhrases": [
                "application number statistics",
                "how many NDAs",
                "count by application type"
              ]
            }
          ]
        },
        {
          "category": "Pharmacologic Class Navigation",
          "description": "Search by therapeutic/pharmacologic class",
          "endpoints": [
            {
              "name": "Search by Pharmacologic Class",
              "method": "GET",
              "path": "/api/views/pharmacologic-class/search",
              "description": "Find products by therapeutic category (e.g., Beta Blockers, ACE Inhibitors)",
              "parameters": {
                "classNameSearch": {
                  "type": "string",
                  "required": true,
                  "description": "Search term for pharmacologic class name"
                },
                "pageNumber": { "type": "integer", "required": false },
                "pageSize": { "type": "integer", "required": false }
              },
              "responseType": "array",
              "triggerPhrases": [
                "find by drug class",
                "search therapeutic class",
                "beta blockers",
                "ACE inhibitors",
                "drugs in class"
              ]
            },
            {
              "name": "Pharmacologic Class Summaries",
              "method": "GET",
              "path": "/api/views/pharmacologic-class/summaries",
              "description": "Get pharmacologic class statistics with product counts",
              "parameters": {
                "pageNumber": { "type": "integer", "required": false },
                "pageSize": { "type": "integer", "required": false }
              },
              "responseType": "array",
              "triggerPhrases": [
                "drug class statistics",
                "most common drug classes",
                "therapeutic categories"
              ]
            }
          ]
        },
        {
          "category": "Ingredient Navigation",
          "description": "Search by active ingredient (UNII or substance name)",
          "endpoints": [
            {
              "name": "Search by Ingredient",
              "method": "GET",
              "path": "/api/views/ingredient/search",
              "description": "Find products containing a specific active ingredient",
              "parameters": {
                "unii": {
                  "type": "string",
                  "required": false,
                  "description": "FDA Unique Ingredient Identifier"
                },
                "substanceNameSearch": {
                  "type": "string",
                  "required": false,
                  "description": "Ingredient/substance name to search"
                },
                "pageNumber": { "type": "integer", "required": false },
                "pageSize": { "type": "integer", "required": false }
              },
              "notes": "At least one of unii or substanceNameSearch is required",
              "responseType": "array",
              "triggerPhrases": [
                "find by ingredient",
                "products containing",
                "drugs with aspirin",
                "search by substance",
                "active ingredient"
              ]
            },
            {
              "name": "Ingredient Summaries",
              "method": "GET",
              "path": "/api/views/ingredient/summaries",
              "description": "Get ingredient statistics ranked by product frequency",
              "parameters": {
                "minProductCount": {
                  "type": "integer",
                  "required": false,
                  "description": "Minimum product count filter"
                },
                "pageNumber": { "type": "integer", "required": false },
                "pageSize": { "type": "integer", "required": false }
              },
              "responseType": "array",
              "triggerPhrases": [
                "most common ingredients",
                "ingredient statistics",
                "popular active ingredients"
              ]
            }
          ]
        },
        {
          "category": "NDC Navigation",
          "description": "Search by National Drug Code (product or package level)",
          "endpoints": [
            {
              "name": "Search by Product NDC",
              "method": "GET",
              "path": "/api/views/ndc/search",
              "description": "Find products by NDC product code",
              "parameters": {
                "productCode": {
                  "type": "string",
                  "required": true,
                  "description": "NDC product code (e.g., 12345-678-90)"
                },
                "pageNumber": { "type": "integer", "required": false },
                "pageSize": { "type": "integer", "required": false }
              },
              "responseType": "array",
              "triggerPhrases": [
                "search by NDC",
                "find NDC",
                "national drug code",
                "product code"
              ]
            },
            {
              "name": "Search by Package NDC",
              "method": "GET",
              "path": "/api/views/ndc/package/search",
              "description": "Search package configurations by NDC package code",
              "parameters": {
                "packageCode": {
                  "type": "string",
                  "required": true,
                  "description": "NDC package code"
                },
                "pageNumber": { "type": "integer", "required": false },
                "pageSize": { "type": "integer", "required": false }
              },
              "responseType": "array",
              "triggerPhrases": [
                "package NDC",
                "package code search"
              ]
            }
          ]
        },
        {
          "category": "Labeler Navigation",
          "description": "Search by manufacturer/marketing organization",
          "endpoints": [
            {
              "name": "Search by Labeler",
              "method": "GET",
              "path": "/api/views/labeler/search",
              "description": "Find products by labeler/manufacturer name",
              "parameters": {
                "labelerNameSearch": {
                  "type": "string",
                  "required": true,
                  "description": "Labeler/manufacturer name to search"
                },
                "pageNumber": { "type": "integer", "required": false },
                "pageSize": { "type": "integer", "required": false }
              },
              "responseType": "array",
              "triggerPhrases": [
                "products by manufacturer",
                "find by labeler",
                "Pfizer products",
                "manufactured by",
                "company products"
              ]
            },
            {
              "name": "Labeler Summaries",
              "method": "GET",
              "path": "/api/views/labeler/summaries",
              "description": "Get labeler statistics with product counts",
              "parameters": {
                "pageNumber": { "type": "integer", "required": false },
                "pageSize": { "type": "integer", "required": false }
              },
              "responseType": "array",
              "triggerPhrases": [
                "top manufacturers",
                "labeler statistics",
                "companies with most products"
              ]
            }
          ]
        },
        {
          "category": "Document Navigation",
          "description": "Navigate SPL documents and version history",
          "endpoints": [
            {
              "name": "Search Documents",
              "method": "GET",
              "path": "/api/views/document/search",
              "description": "Search documents by product name",
              "parameters": {
                "productNameSearch": {
                  "type": "string",
                  "required": true,
                  "description": "Product name to search"
                },
                "pageNumber": { "type": "integer", "required": false },
                "pageSize": { "type": "integer", "required": false }
              },
              "responseType": "array",
              "triggerPhrases": [
                "find document",
                "search product name",
                "LIPITOR document",
                "prescribing information for"
              ]
            },
            {
              "name": "Document Version History",
              "method": "GET",
              "path": "/api/views/document/version-history/{setGuidOrDocumentGuid}",
              "description": "Get version history for a document set",
              "parameters": {
                "setGuidOrDocumentGuid": {
                  "type": "guid",
                  "required": true,
                  "location": "path",
                  "description": "SetGUID or DocumentGUID"
                }
              },
              "responseType": "array",
              "triggerPhrases": [
                "version history",
                "document versions",
                "label changes"
              ]
            }
          ]
        },
        {
          "category": "Section Navigation",
          "description": "Search labeling sections by LOINC code",
          "endpoints": [
            {
              "name": "Search by Section Code",
              "method": "GET",
              "path": "/api/views/section/search",
              "description": "Find sections by LOINC code",
              "parameters": {
                "sectionCode": {
                  "type": "string",
                  "required": true,
                  "description": "LOINC section code"
                },
                "pageNumber": { "type": "integer", "required": false },
                "pageSize": { "type": "integer", "required": false }
              },
              "responseType": "array",
              "commonLoincCodes": {
                "34066-1": "Boxed Warning",
                "34067-9": "Indications and Usage",
                "34068-7": "Dosage and Administration",
                "34069-5": "Contraindications",
                "34070-3": "Warnings",
                "34071-1": "Warnings and Precautions",
                "34072-9": "Precautions",
                "34073-7": "Drug Interactions",
                "34074-5": "Drug/Laboratory Test Interactions",
                "34084-4": "Adverse Reactions",
                "34088-5": "Overdosage",
                "34090-1": "Clinical Pharmacology"
              },
              "triggerPhrases": [
                "find boxed warnings",
                "show contraindications",
                "drug interactions section",
                "adverse reactions"
              ]
            },
            {
              "name": "Section Summaries",
              "method": "GET",
              "path": "/api/views/section/summaries",
              "description": "Get section type statistics",
              "parameters": {
                "pageNumber": { "type": "integer", "required": false },
                "pageSize": { "type": "integer", "required": false }
              },
              "responseType": "array",
              "triggerPhrases": [
                "section statistics",
                "most common sections"
              ]
            }
          ]
        }
      ]
    },
    "labelCrud": {
      "description": "CRUD operations for label data sections",
      "requiresAuth": {
        "read": false,
        "write": true
      },
      "endpoints": [
        {
          "name": "Get Section Menu",
          "method": "GET",
          "path": "/api/labels/sectionMenu",
          "description": "List all available label sections",
          "responseType": "array",
          "triggerPhrases": ["what sections are available", "list entity types"]
        },
        {
          "name": "Get Section Documentation",
          "method": "GET",
          "path": "/api/labels/{menuSelection}/documentation",
          "description": "Get schema documentation for a section",
          "parameters": {
            "menuSelection": {
              "type": "string",
              "required": true,
              "location": "path",
              "description": "Section/entity name"
            }
          },
          "triggerPhrases": ["document schema", "what fields does X have"]
        },
        {
          "name": "Get Section Records",
          "method": "GET",
          "path": "/api/labels/section/{menuSelection}",
          "description": "Get all records for a section with pagination",
          "parameters": {
            "menuSelection": { "type": "string", "required": true, "location": "path" },
            "pageNumber": { "type": "integer", "required": false },
            "pageSize": { "type": "integer", "required": false }
          },
          "responseType": "array"
        },
        {
          "name": "Get Record by ID",
          "method": "GET",
          "path": "/api/labels/{menuSelection}/{encryptedId}",
          "description": "Get a specific record by encrypted ID",
          "parameters": {
            "menuSelection": { "type": "string", "required": true, "location": "path" },
            "encryptedId": { "type": "string", "required": true, "location": "path" }
          },
          "responseType": "object"
        },
        {
          "name": "Get Complete Document",
          "method": "GET",
          "path": "/api/labels/single/{documentGuid}",
          "description": "Get complete document with all related sections",
          "parameters": {
            "documentGuid": { "type": "guid", "required": true, "location": "path" }
          },
          "responseType": "object",
          "triggerPhrases": ["full document", "complete label", "all sections for"]
        },
        {
          "name": "Create Record",
          "method": "POST",
          "path": "/api/labels/{menuSelection}",
          "description": "Create a new record in a section",
          "requiresAuth": true,
          "parameters": {
            "menuSelection": { "type": "string", "required": true, "location": "path" }
          },
          "body": "JSON object matching section schema"
        },
        {
          "name": "Update Record",
          "method": "PUT",
          "path": "/api/labels/{menuSelection}/{encryptedId}",
          "description": "Update an existing record",
          "requiresAuth": true,
          "parameters": {
            "menuSelection": { "type": "string", "required": true, "location": "path" },
            "encryptedId": { "type": "string", "required": true, "location": "path" }
          },
          "body": "JSON object with updated fields"
        },
        {
          "name": "Delete Record",
          "method": "DELETE",
          "path": "/api/labels/{menuSelection}/{encryptedId}",
          "description": "Delete a record",
          "requiresAuth": true,
          "parameters": {
            "menuSelection": { "type": "string", "required": true, "location": "path" },
            "encryptedId": { "type": "string", "required": true, "location": "path" }
          }
        }
      ],
      "availableSections": [
        { "name": "Document", "description": "Main SPL document metadata" },
        { "name": "Organization", "description": "Companies and regulatory bodies" },
        { "name": "Product", "description": "Drug products" },
        { "name": "ActiveMoiety", "description": "Active moiety substances" },
        { "name": "ActiveIngredient", "description": "Active ingredients with strengths" },
        { "name": "InactiveIngredient", "description": "Inactive/excipient ingredients" },
        { "name": "Section", "description": "Document sections (by LOINC code)" },
        { "name": "Subsection", "description": "Nested content within sections" },
        { "name": "PackagingLevel", "description": "Package hierarchy levels" },
        { "name": "PackageItem", "description": "Individual package items" },
        { "name": "ProductIdentifier", "description": "NDC and other product codes" },
        { "name": "PackageIdentifier", "description": "Package-level NDC codes" },
        { "name": "Characteristic", "description": "Physical characteristics (color, shape, etc.)" },
        { "name": "MarketingCategory", "description": "NDA, ANDA, BLA, OTC classifications" },
        { "name": "Route", "description": "Routes of administration" },
        { "name": "EquivalentSubstance", "description": "Equivalent substance mappings" },
        { "name": "PharmacologicClass", "description": "Therapeutic/pharmacologic classifications" },
        { "name": "DrugInteraction", "description": "Drug interaction data" },
        { "name": "ContraindicatedDrug", "description": "Contraindicated drug combinations" },
        { "name": "ItemContains", "description": "Container contents relationships" },
        { "name": "ContainedItem", "description": "Items contained within packages" },
        { "name": "Address", "description": "Organization addresses" },
        { "name": "BusinessOperation", "description": "Manufacturing/distribution operations" }
      ]
    },
    "importExport": {
      "description": "SPL data import and export operations",
      "endpoints": [
        {
          "name": "Import SPL ZIP Files",
          "method": "POST",
          "path": "/api/labels/import",
          "description": "Import SPL data from ZIP files containing XML",
          "requiresAuth": true,
          "contentType": "multipart/form-data",
          "parameters": {
            "files": {
              "type": "file[]",
              "required": true,
              "description": "ZIP files containing SPL XML files"
            }
          },
          "notes": "Returns operationId for progress tracking. ZIP files available from DailyMed.",
          "dailyMedUrl": "https://dailymed.nlm.nih.gov/dailymed/spl-resources-all-drug-labels.cfm",
          "triggerPhrases": [
            "import SPL",
            "upload labels",
            "import data",
            "load ZIP files"
          ]
        },
        {
          "name": "Get Import Progress",
          "method": "GET",
          "path": "/api/labels/import/progress/{operationId}",
          "description": "Check progress of an import operation",
          "parameters": {
            "operationId": { "type": "string", "required": true, "location": "path" }
          }
        },
        {
          "name": "Generate SPL XML",
          "method": "GET",
          "path": "/api/labels/generate/{documentGuid}/{minify}",
          "description": "Generate SPL XML from stored document data",
          "parameters": {
            "documentGuid": { "type": "guid", "required": true, "location": "path" },
            "minify": { "type": "boolean", "required": false, "location": "path", "default": false }
          },
          "responseType": "xml",
          "triggerPhrases": ["export XML", "generate SPL", "download label"]
        }
      ]
    },
    "comparisonAnalysis": {
      "description": "AI-powered comparison between source XML and database representation",
      "endpoints": [
        {
          "name": "Queue Comparison Analysis",
          "method": "POST",
          "path": "/api/labels/comparison/analysis/{documentGuid}",
          "description": "Start AI analysis comparing XML with DTO representation",
          "parameters": {
            "documentGuid": { "type": "guid", "required": true, "location": "path" }
          },
          "triggerPhrases": ["compare document", "analyze differences", "validate import"]
        },
        {
          "name": "Get Comparison Results",
          "method": "GET",
          "path": "/api/labels/comparison/analysis/{documentGuid}",
          "description": "Get cached comparison results"
        },
        {
          "name": "Get Comparison Progress",
          "method": "GET",
          "path": "/api/labels/comparison/progress/{operationId}",
          "description": "Check progress of comparison analysis"
        }
      ]
    },
    "authentication": {
      "description": "Authentication and session management",
      "endpoints": [
        {
          "name": "OAuth Login",
          "method": "GET",
          "path": "/api/auth/login/{provider}",
          "description": "Initiate OAuth login flow",
          "parameters": {
            "provider": {
              "type": "string",
              "required": true,
              "location": "path",
              "allowedValues": ["Google", "Microsoft"]
            }
          },
          "triggerPhrases": ["log in", "sign in", "authenticate"]
        },
        {
          "name": "Get Current User",
          "method": "GET",
          "path": "/api/auth/user",
          "description": "Get authenticated user information",
          "requiresAuth": true
        },
        {
          "name": "Logout",
          "method": "POST",
          "path": "/api/auth/logout",
          "description": "End current session",
          "requiresAuth": true,
          "triggerPhrases": ["log out", "sign out"]
        }
      ]
    },
    "userManagement": {
      "description": "User profile and activity management",
      "endpoints": [
        {
          "name": "Get My Profile",
          "method": "GET",
          "path": "/api/users/me",
          "description": "Get current user's profile",
          "requiresAuth": true,
          "triggerPhrases": ["my profile", "my account"]
        },
        {
          "name": "Get User Activity",
          "method": "GET",
          "path": "/api/users/user/{encryptedUserId}/activity",
          "description": "Get user's activity log",
          "requiresAuth": true,
          "parameters": {
            "encryptedUserId": { "type": "string", "required": true, "location": "path" },
            "pageNumber": { "type": "integer", "required": false },
            "pageSize": { "type": "integer", "required": false }
          },
          "triggerPhrases": ["my activity", "what have I done"]
        }
      ]
    }
  },
  "contextualResponses": {
    "emptyDatabase": {
      "condition": "isDatabaseEmpty == true",
      "response": "The database is currently empty. To get started with MedRecPro, you'll need to import SPL (Structured Product Labeling) data. You can download ZIP files containing SPL XML from DailyMed (https://dailymed.nlm.nih.gov/dailymed/spl-resources-all-drug-labels.cfm) and use the import endpoint to load them. Would you like me to explain the import process?",
      "suggestedAction": {
        "method": "POST",
        "path": "/api/labels/import",
        "description": "Import SPL ZIP files"
      }
    },
    "demoMode": {
      "condition": "isDemoMode == true",
      "note": "In demo mode, the database is periodically reset. User accounts and activity logs are preserved, but label data may be removed."
    },
    "authRequired": {
      "condition": "isAuthenticated == false && operationRequiresAuth",
      "response": "This operation requires authentication. Please log in using Google or Microsoft OAuth to continue.",
      "suggestedAction": {
        "method": "GET",
        "path": "/api/auth/login/Google",
        "description": "Log in with Google"
      }
    }
  },
  "interpretationGuidelines": {
    "priorityOrder": [
      "Check if database is empty - suggest import if so",
      "Determine if request requires authentication",
      "Match intent to most specific endpoint",
      "Use search endpoints for discovery queries",
      "Use CRUD endpoints for specific record operations",
      "Provide clarifying questions for ambiguous requests"
    ],
    "commonPatterns": [
      {
        "pattern": "find/search/show products by ingredient",
        "endpoint": "/api/views/ingredient/search",
        "extractParameter": "substanceNameSearch"
      },
      {
        "pattern": "find/search/show products by manufacturer/labeler/company",
        "endpoint": "/api/views/labeler/search",
        "extractParameter": "labelerNameSearch"
      },
      {
        "pattern": "find/search by NDC/national drug code",
        "endpoint": "/api/views/ndc/search",
        "extractParameter": "productCode"
      },
      {
        "pattern": "find/search by application number/NDA/ANDA/BLA",
        "endpoint": "/api/views/application-number/search",
        "extractParameter": "applicationNumber"
      },
      {
        "pattern": "find/search by drug class/therapeutic class",
        "endpoint": "/api/views/pharmacologic-class/search",
        "extractParameter": "classNameSearch"
      },
      {
        "pattern": "show/get boxed warnings/contraindications/interactions",
        "endpoint": "/api/views/section/search",
        "extractParameter": "sectionCode",
        "mapToLoincCode": true
      },
      {
        "pattern": "import/load/upload SPL/labels/data",
        "endpoint": "/api/labels/import",
        "requiresAuth": true
      }
    ]
  }
}
