<?xml version="1.0" encoding="utf-8"?>
<configuration>
	<!-- httpErrors MUST be outside the <location> element so IIS applies it at the
	     application level before evaluating location-scoped settings. With PassThrough,
	     IIS will not replace Kestrel's 401/404 responses with its own HTML error pages.
	     Critical for MCP OAuth: the 401 must include the WWW-Authenticate header
	     from McpAuthenticationHandler for Claude to discover the OAuth flow. -->
	<system.webServer>
		<httpErrors existingResponse="PassThrough" />
	</system.webServer>
	<location path="." inheritInChildApplications="false">
		<system.webServer>
			<handlers>
				<add name="aspNetCore" path="*" verb="*" modules="AspNetCoreModuleV2" resourceType="Unspecified" />
			</handlers>
			<aspNetCore processPath="dotnet" arguments=".\MedRecProMCP.dll" stdoutLogEnabled="true" stdoutLogFile="\\?\%home%\LogFiles\stdout-mcp" hostingModel="OutOfProcess" />
		</system.webServer>
	</location>
</configuration>
